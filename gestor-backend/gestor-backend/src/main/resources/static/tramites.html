<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Asignar Tr√°mite a Cliente</title>
  <link rel="stylesheet" href="css/styles.css" />
  <style>
    .tramite-form-container {
      max-width: 900px;
      margin: 0 auto;
    }

    .form-section {
      background: white;
      border-radius: 12px;
      padding: 28px;
      margin-bottom: 24px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      color: #333;
    }

    .form-section .label {
      color: #2a0056 !important;
      font-weight: 700;
    }

    .form-section .input,
    .form-section select,
    .form-section textarea {
      color: #1a1a1a !important;
    }

    .form-section small {
      color: #666 !important;
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 2px solid #5a0fb2;
    }

    .section-header h3 {
      margin: 0;
      color: #2a0056;
      font-size: 18px;
    }

    .section-icon {
      font-size: 24px;
    }

    .form-grid-2 {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }

    .info-badge {
      background: linear-gradient(135deg, #f8f3ff 0%, #fff 100%);
      border-left: 4px solid #5a0fb2;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 14px;
      color: #333;
    }

    .info-badge strong {
      color: #2a0056;
      display: block;
      margin-bottom: 4px;
      font-weight: 700;
    }

    .cliente-preview {
      background: linear-gradient(135deg, #2a0056 0%, #5a0fb2 100%);
      color: white;
      padding: 20px;
      border-radius: 8px;
      margin-top: 12px;
      display: none;
    }

    .cliente-preview.show {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    .cliente-preview h4 {
      margin: 0 0 12px 0;
      font-size: 16px;
    }

    .cliente-preview-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      font-size: 13px;
    }

    .cliente-preview-item {
      display: flex;
      flex-direction: column;
    }

    .cliente-preview-label {
      opacity: 0.8;
      font-size: 11px;
      margin-bottom: 2px;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @media (max-width: 768px) {
      .form-grid-2 {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body data-page="tramites" class="page">
  <aside class="sidebar">
    <div class="profile">
      <div class="avatar"></div>
      <div>
        <div style="font-weight:800" id="user-name">USUARIO</div>
        <div class="small" id="user-email">email@example.com</div>
      </div>
    </div>
    <nav class="nav">
      <a href="dashboard.html">INICIO</a>
      <a href="clientes.html">AGREGAR CLIENTES</a>
      <a href="listado-clientes.html">LISTADO DE CLIENTES</a>
      <a href="datos.html">DATOS</a>
      <a class="active" href="tramites.html">TR√ÅMITES</a>
      <a href="consulta-tramites.html">CONSULTA TR√ÅMITES</a>
      <a href="tipos-tramites.html">TIPOS DE TR√ÅMITES</a>
      <a href="notificaciones.html">NOTIFICACIONES</a>
      <a href="#" class="small" onclick="logout(event)">Log out</a>
    </nav>
  </aside>

  <main class="main">
    <div class="tramite-form-container">
      <h2 class="section-title">üìã Asignar Tr√°mite a Cliente</h2>

      <div class="info-badge">
        <strong>‚ÑπÔ∏è ¬øC√≥mo funciona?</strong>
        Primero selecciona el cliente, luego completa la informaci√≥n del tr√°mite que deseas asignarle. El sistema crear√° el tr√°mite y lo asociar√° autom√°ticamente al cliente seleccionado.
      </div>

      <form id="tramitesForm">
        <!-- SECCI√ìN 1: SELECCI√ìN DE CLIENTE -->
        <div class="form-section">
          <div class="section-header">
            <span class="section-icon">üë§</span>
            <h3>Paso 1: Seleccionar Cliente</h3>
          </div>

          <div class="form-col">
            <label class="label">CLIENTE *</label>
            <select id="selectCliente" name="clienteId" class="input" required>
              <option value="">Cargando clientes...</option>
            </select>
          </div>

          <div id="cliente-preview" class="cliente-preview">
            <h4>‚úì Cliente seleccionado</h4>
            <div class="cliente-preview-grid">
              <div class="cliente-preview-item">
                <span class="cliente-preview-label">NOMBRE</span>
                <span id="preview-nombre">-</span>
              </div>
              <div class="cliente-preview-item">
                <span class="cliente-preview-label">DPI</span>
                <span id="preview-dpi">-</span>
              </div>
              <div class="cliente-preview-item">
                <span class="cliente-preview-label">TEL√âFONO</span>
                <span id="preview-telefono">-</span>
              </div>
              <div class="cliente-preview-item">
                <span class="cliente-preview-label">FECHA NAC.</span>
                <span id="preview-fecha">-</span>
              </div>
            </div>
          </div>
        </div>

        <!-- SECCI√ìN 2: INFORMACI√ìN DEL TR√ÅMITE -->
        <div class="form-section">
          <div class="section-header">
            <span class="section-icon">üìÑ</span>
            <h3>Paso 2: Informaci√≥n del Tr√°mite</h3>
          </div>

          <div class="form-col">
            <label class="label">NOMBRE DEL TR√ÅMITE *</label>
            <input name="nombre" class="input" placeholder="Ej: Inscripci√≥n SAT, Renovaci√≥n NIT, etc." maxlength="50" required />
            <small style="color:#999;font-size:12px;margin-top:4px;display:block;">M√°ximo 50 caracteres</small>
          </div>

          <div class="form-col">
            <label class="label">DESCRIPCI√ìN</label>
            <textarea name="descripcion" class="input" placeholder="Describe brevemente el tr√°mite y requisitos..." maxlength="500" rows="4" style="resize:vertical;font-family:inherit;"></textarea>
            <small style="color:#999;font-size:12px;margin-top:4px;display:block;">M√°ximo 500 caracteres (opcional)</small>
          </div>

          <div class="form-col">
            <label class="label">TIPO / CATEGOR√çA *</label>
            <select name="idTipoTramite" class="input" required>
              <option value="">-- Seleccionar categor√≠a --</option>
              <option value="1">üèõÔ∏è SAT (Superintendencia de Administraci√≥n Tributaria)</option>
              <option value="2">üíº CGC (Contralor√≠a General de Cuentas)</option>
              <option value="3">üìä CONSULTA RAE (Registro de Antecedentes)</option>
              <option value="4">üÜî RENAS (Registro Nacional de Personas)</option>
            </select>
          </div>
        </div>

        <!-- SECCI√ìN 3: ESTADO Y FECHA -->
        <div class="form-section">
          <div class="section-header">
            <span class="section-icon">‚öôÔ∏è</span>
            <h3>Paso 3: Estado Inicial</h3>
          </div>

          <div class="form-grid-2">
            <div class="form-col">
              <label class="label">ESTADO INICIAL *</label>
              <select name="estadoInicial" class="input" required>
                <option value="PENDIENTE">‚è≥ PENDIENTE - Por iniciar</option>
                <option value="INICIADO">üîÑ INICIADO - En tr√°mite</option>
                <option value="TERMINADO">‚úÖ TERMINADO - Completado</option>
              </select>
            </div>

            <div class="form-col">
              <label class="label">FECHA DE INICIO *</label>
              <input type="date" name="fechaInicio" class="input" required />
            </div>
          </div>
        </div>

        <div class="footer-actions" style="margin-top:32px;">
          <button type="submit" class="btn btn-navy">üíæ GUARDAR Y ASIGNAR TR√ÅMITE</button>
          <button type="button" class="btn btn-outline" onclick="window.location.href='consulta-tramites.html'">
            Cancelar
          </button>
        </div>
      </form>
    </div>
  </main>

  <!-- Modal Tr√°mite Guardado -->
  <div class="modal" id="modal-tramite-ok">
    <div class="modal-content">
      <h3 style="color:#2a0056;">‚úÖ Tr√°mite Asignado Exitosamente</h3>
      <p style="margin:16px 0;color:#333;">El tr√°mite ha sido creado y asignado al cliente seleccionado.</p>
      <button class="btn btn-navy" onclick="irAConsultaTramites()">Ver Tr√°mites</button>
      <button class="btn btn-outline" onclick="cerrarModalYLimpiar()" style="margin-left:8px;">Agregar Otro</button>
    </div>
  </div>

  <script src="js/config.js"></script>
  <script src="js/api-service.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/app.js"></script>
  <script>
    // Establecer fecha actual por defecto
    document.addEventListener('DOMContentLoaded', () => {
      const fechaInput = document.querySelector('[name="fechaInicio"]');
      if (fechaInput) {
        fechaInput.value = new Date().toISOString().split('T')[0];
      }
    });

    function irAConsultaTramites() {
      window.location.href = 'consulta-tramites.html';
    }

    function cerrarModalYLimpiar() {
      document.getElementById('modal-tramite-ok').classList.remove('show');
      document.getElementById('tramitesForm').reset();
      document.getElementById('cliente-preview').classList.remove('show');
      const fechaInput = document.querySelector('[name="fechaInicio"]');
      if (fechaInput) {
        fechaInput.value = new Date().toISOString().split('T')[0];
      }
    }
  </script>
</body>
</html>
